<%- include('partials/appheader') %>


<body class="adminbody">

  <main class="admin-dashboard">
    <header class="dashboard-header">
      <h1 class="dashboard-title">Admin Dashboard</h1>
      <p class="welcome-message">Welcome back, <strong><%= user.username %></strong>. Full administrative privileges active.</p>
      <section class="admin-status">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/>
        </svg>
        <span>Super Admin Access</span><br>
      
      </section>
    </header>
  
    <section class="admin-actions" aria-labelledby="quick-actions-heading">
      <h2 id="quick-actions-heading" class="section-title">
        <svg class="section-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
        </svg>
        Quick Actions
      </h2>
  
      <section class="action-grid">
        <article class="action-card">
          <a href="/researcher/projects/create" class="action-link">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M19 3H5c-1.1 0-1.99.9-1.99 2L3 19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 11h-3v3c0 .55-.45 1-1 1h-2c-.55 0-1-.45-1-1v-3H7c-.55 0-1-.45-1-1v-2c0-.55.45-1 1-1h3V7c0-.55.45-1 1-1h2c.55 0 1 .45 1 1v3h3c.55 0 1 .45 1 1v2c0 .55-.45 1-1 1z"/>
            </svg>
            <h3>Create New Project</h3>
            <p>Initiate a research project</p>
          </a>
        </article>
  
        <article class="action-card">
          <a href="/researcher/projects/my-projects" class="action-link">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
            </svg>
            <h3>Manage Projects</h3>
            <p>View all research projects</p>
          </a>
        </article>
  
        <article class="action-card">
          <a href="/admin/users" class="action-link">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
            </svg>
            <h3>User Management</h3>
            <p>Add/remove system users</p>
          </a>
        </article>
  
        <article class="action-card">
          <a href="/admin/analytics" class="action-link">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-5h2v5zm4 0h-2v-3h2v3zm0-5h-2v-2h2v2zm4 5h-2V7h2v10z"/>
            </svg>
            <h3>Platform Analytics</h3>
            <p>View usage statistics</p>
          </a>
        </article>
      </section>
    </section>
  
    <section class="user-management" aria-labelledby="user-management-heading">
      <h2 id="user-management-heading" class="section-title">
        <svg class="section-icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
        </svg>
        User Administration
      </h2>
  
        <article class="management-card">
          <h3>Manage Existing Users</h3>
          <form class="admin-form" action="/researcher/projects/users/remove" method="POST">
            <label for="searchInput">Search User by Username</label>
            <div class="d-flex mb-3">
              <input type="text" id="searchInput" name="username" class="form-control me-2" placeholder="Search by username..." required>
              <button type="submit" class="btn btn-danger">Remove User</button>
            </div>
          </form>                
        </article>
      </div>
    </section>
  
    <nav class="admin-footer" aria-label="Admin navigation">
      <a href="/admin/settings" class="footer-link">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/>
        </svg>
        System Settings
      </a>
      <form action="/logout" method="get" class="logout-form">
        <button type="submit" class="logout-button">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/>
          </svg>
          Logout
        </button>
      </form>
    </nav>
  </main>

</body>


<%- include('partials/footer') %>

<script>
  const removeForm = document.querySelector('.admin-form');

  removeForm.addEventListener('submit', async function (e) {
    e.preventDefault(); // stop normal form submission

    const confirmDelete = confirm("Are you sure you want to delete this user?");
    if (!confirmDelete) return;

    const formData = new FormData(removeForm);
    const username = formData.get('username');

    try {
      const response = await fetch('/researcher/projects/users/remove', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ username })
      });

      const data = await response.json();

      if (data.success) {
        alert(data.message); // Show popup
        window.location.href = '/Admin/Home'; // Then redirect
      } else {
        alert(data.message); // Show error message (e.g., User not found)
      }
    } catch (error) {
      console.error('Request failed:', error);
      alert("Something went wrong while trying to delete the user.");
    }
  });
</script>


